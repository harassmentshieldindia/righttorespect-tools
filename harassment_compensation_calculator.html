        // Error Handling System with enhanced compatibility
        class ErrorHandler {
            static instance = null;

            constructor() {
                if (ErrorHandler.instance) {
                    return ErrorHandler.instance;
                }
                ErrorHandler.instance = this;
                this.console = safeConsole;
                this.setupGlobalErrorHandling();
            }

            setupGlobalErrorHandling() {
                window.addEventListener('error', (event) => {
                    this.handleError('JavaScript Error', event.error?.message || 'Unknown error occurred');
                });

                window.addEventListener('unhandledrejection', (event) => {
                    this.handleError('Promise Rejection', event.reason?.message || 'Unhandled promise rejection');
                });

                // Custom error handling for calculation errors
                window.addEventListener('calculationError', (event) => {
                    this.handleError('Calculation Error', event.detail?.message || 'Calculation failed');
                });
            }

            handleError(type, message) {
                this.console.error(`[${type}]:`, message);
                this.showError(`${message}`);
                this.announceError(message);
            }

            showError(message) {
                try {
                    const banner = document.getElementById('errorBanner');
                    const messageEl = document.getElementById('errorMessage');
                    
                    if (banner && messageEl) {
                        messageEl.textContent = message;
                        banner.classList.add('show');
                        
                        // Auto-hide after 5 seconds
                        setTimeout(() => this.hideError(), 5000);
                    }
                } catch (error) {
                    this.console.error('Error display failed:', error);
                }
            }

            hideError() {
                try {
                    const banner = document.getElementById('errorBanner');
                    if (banner) {
                        banner.classList.remove('show');
                    }
                } catch (error) {
                    this.console.error('Error hiding failed:', error);
                }
            }

            announceError(message) {
                this.announceToScreenReader(message, 'alert');
            }

            announceToScreenReader(message, type = 'polite') {
                try {
                    const announcer = document.getElementById(type === 'alert' ? 'sr-alert' : 'sr-live');
                    if (announcer) {
                        announcer.textContent = message;
                        setTimeout(() => announcer.textContent = '', 1000);
                    }
                } catch (error) {
                    this.console.error('Screen reader announcement failed:', error);
                }
            }
        }

        // Cross-browser compatibility checks with enhanced error handling
        function checkBrowserCompatibility() {
            try {
                const features = {
                    'CSS Grid': 'grid' in document.documentElement.style,
                    'CSS Custom Properties': typeof CSS !== 'undefined' && 'supports' in CSS && CSS.supports('--test', 'value'),
                    'Backdrop Filter': 'backdropFilter' in document.documentElement.style,
                    'Performance API': 'performance' in window,
                    'Intersection Observer': 'IntersectionObserver' in window,
                    'Console API': 'console' in window && typeof console.log === 'function'
                };

                safeConsole.group('üåê Browser Compatibility');
                Object.entries(features).forEach(([feature, supported]) => {
                    safeConsole.log(`${supported ? '‚úÖ' : '‚ùå'} ${feature}: ${supported ? 'Supported' : 'Not Supported'}`);
                });
                safeConsole.groupEnd();

                // Apply fallbacks for unsupported features
                if (!features['CSS Custom Properties']) {
                    document.documentElement.style.setProperty = document.documentElement.style.setProperty || function() {};
                }

                if (!features['Performance API']) {
                    window.performance = window.performance || {
                        now: () => Date.now(),
                        memory: { usedJSHeapSize: 0 }
                    };
                }

                return features;
            } catch (error) {
                safeConsole.error('Browser compatibility check failed:', error);
                return {};
            }
        }

        // Enhanced main calculation function with better error handling
        async function calculateCompensation() {
            const startTime = performance.now();
            
            try {
                // Show loading state
                const button = document.getElementById('calculateButton');
                if (!button) {
                    throw new Error('Calculate button not found');
                }

                const originalText = button.innerHTML;
                button.innerHTML = '<span class="loading"></span><span data-en="Calculating..." data-hi="‡§ó‡§£‡§®‡§æ ‡§ï‡•Ä ‡§ú‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à...">Calculating...</span>';
                button.disabled = true;

                // Validate inputs with enhanced error messages
                const validation = validateCalculationInputs();
                if (!validation.isValid) {
                    throw new Error(validation.message);
                }

                // Collect form data safely
                const formData = collectFormData();
                const impacts = collectSelectedImpacts();

                // Perform calculation with timeout protection
                const results = await Promise.race([
                    performCalculation(formData, impacts),
                    new Promise((_, reject) => 
                        setTimeout(() => reject(new Error('Calculation timeout')), 10000)
                    )
                ]);
                
                // Display results
                await displayResults(results);
                
                // Show success message
                showSuccessMessage();

                // Performance tracking
                if (window.performanceMonitor) {
                    performanceMonitor.incrementCalc();
                }
                
                const calcTime = performance.now() - startTime;
                safeConsole.log(`‚úÖ Calculation completed in ${Math.round(calcTime)}ms`);

                // Accessibility announcement
                if (window.errorHandler) {
                    errorHandler.announceToScreenReader('Compensation calculation completed successfully. Results are now available below.');
                }

            } catch (error) {
                safeConsole.error('Calculation failed:', error);
                if (window.errorHandler) {
                    errorHandler.handleError('Calculation Error', error.message);
                } else {
                    // Fallback error display
                    alert(`Calculation Error: ${error.message}`);
                }
            } finally {
                // Reset button state safely
                try {
                    const button = document.getElementById('calculateButton');
                    if (button) {
                        const currentLang = document.documentElement.lang || 'en';
                        const buttonText = currentLang === 'hi' ? 
                            '‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§Æ‡•Å‡§Ü‡§µ‡§ú‡•á ‡§ï‡•Ä ‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡•á‡§Ç' : 
                            'Calculate Estimated Compensation';
                        button.innerHTML = `<span data-en="Calculate Estimated Compensation" data-hi="‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§Æ‡•Å‡§Ü‡§µ‡§ú‡•á ‡§ï‡•Ä ‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡•á‡§Ç">${buttonText}</span>`;
                        button.disabled = false;
                    }
                } catch (resetError) {
                    safeConsole.error('Button reset failed:', resetError);
                }
            }
        }

        // Enhanced input validation
        function validateCalculationInputs() {
            try {
                const requiredFields = [
                    { id: 'harassmentType', name: 'Harassment Type' },
                    { id: 'duration', name: 'Duration' }
                ];

                const missing = [];
                const invalid = [];

                requiredFields.forEach(field => {
                    const element = document.getElementById(field.id);
                    if (!element) {
                        missing.push(field.name);
                    } else if (!element.value || element.value.trim() === '') {
                        invalid.push(field.name);
                    }
                });

                if (missing.length > 0) {
                    return {
                        isValid: false,
                        message: `Required form elements missing: ${missing.join(', ')}`
                    };
                }

                if (invalid.length > 0) {
                    return {
                        isValid: false,
                        message: `Please fill in required fields: ${invalid.join(', ')}`
                    };
                }

                // Validate numeric inputs
                const monthlyIncome = document.getElementById('monthlyIncome').value;
                const medicalExpenses = document.getElementById('medicalExpenses').value;

                if (monthlyIncome && (isNaN(monthlyIncome) || parseFloat(monthlyIncome) < 0)) {
                    return {
                        isValid: false,
                        message: 'Monthly income must be a valid positive number'
                    };
                }

                if (medicalExpenses && (isNaN(medicalExpenses) || parseFloat(medicalExpenses) < 0)) {
                    return {
                        isValid: false,
                        message: 'Medical expenses must be a valid positive number'
                    };
                }

                return { isValid: true, message: 'Validation successful' };

            } catch (error) {
                safeConsole.error('Validation error:', error);
                return {
                    isValid: false,
                    message: 'Validation process failed. Please check your inputs.'
                };
            }
        }

        // Safe form data collection
        function collectFormData() {
            try {
                return {
                    harassmentType: document.getElementById('harassmentType')?.value || '',
                    duration: document.getElementById('duration')?.value || '',
                    severity: parseInt(document.getElementById('severity')?.value) || 5,
                    monthlyIncome: parseFloat(document.getElementById('monthlyIncome')?.value) || 0,
                    jobLoss: document.getElementById('jobLoss')?.value || 'none',
                    medicalExpenses: parseFloat(document.getElementById('medicalExpenses')?.value) || 0,
                    evidence: document.getElementById('evidence')?.value || 'moderate',
                    witnesses: document.getElementById('witnesses')?.value || 'none'
                };
            } catch (error) {
                safeConsole.error('Form data collection failed:', error);
                throw new Error('Failed to collect form data');
            }
        }

        // Safe impact collection
        function collectSelectedImpacts() {
            try {
                const checkboxes = document.querySelectorAll('.checkbox-grid input[type="checkbox"]:checked');
                return Array.from(checkboxes).map(cb => cb.value).filter(Boolean);
            } catch (error) {
                safeConsole.error('Impact collection failed:', error);
                return [];
            }
        }

        // Safe success message display
        function showSuccessMessage() {
            try {
                const successMsg = document.getElementById('successMessage');
                if (successMsg) {
                    successMsg.style.display = 'flex';
                    setTimeout(() => {
                        if (successMsg.style) {
                            successMsg.style.display = 'none';
                        }
                    }, 3000);
                }
            } catch (error) {
                safeConsole.error('Success message display failed:', error);
            }
        }

        // Enhanced checkbox interaction with error handling
        function toggleCheckbox(checkboxId) {
            try {
                const checkbox = document.getElementById(checkboxId);
                const card = checkbox?.closest('.checkbox-card');
                
                if (!checkbox || !card) {
                    throw new Error(`Checkbox or card not found: ${checkboxId}`);
                }
                
                checkbox.checked = !checkbox.checked;
                card.classList.toggle('selected', checkbox.checked);
                
                // Accessibility announcement with safety check
                if (window.calculator && calculator.announceCheckboxChange) {
                    calculator.announceCheckboxChange(checkbox);
                }
            } catch (error) {
                safeConsole.error('Checkbox toggle failed:', error);
                if (window.errorHandler) {
                    errorHandler.handleError('UI Error', 'Checkbox interaction failed');
                }
            }
        }

        // Safe language switching
        function switchLanguage(lang) {
            try {
                if (!lang || (lang !== 'en' && lang !== 'hi')) {
                    throw new Error('Invalid language code');
                }

                if (window.languageManager && languageManager.switchLanguage) {
                    languageManager.switchLanguage(lang);
                } else {
                    // Fallback language switching
                    document.documentElement.lang = lang;
                    
                    document.querySelectorAll('.language-btn').forEach(btn => {
                        if (btn.dataset && btn.dataset.lang) {
                            btn.classList.toggle('active', btn.dataset.lang === lang);
                        }
                    });

                    // Update text content with fallback
                    updateTextContentFallback(lang);
                }
            } catch (error) {
                safeConsole.error('Language switching failed:', error);
                if (window.errorHandler) {
                    errorHandler.handleError('Language Error', 'Language switching failed');
                }
            }
        }

        // Fallback text content update
        function updateTextContentFallback(lang) {
            try {
                document.querySelectorAll('[data-en][data-hi]').forEach(element => {
                    const text = element.getAttribute(`data-${lang}`);
                    if (text) {
                        if (element.tagName === 'INPUT' && element.type !== 'checkbox') {
                            element.placeholder = text;
                        } else {
                            element.textContent = text;
                        }
                    }
                });

                // Update select options
                document.querySelectorAll('option[data-en][data-hi]').forEach(option => {
                    const text = option.getAttribute(`data-${lang}`);
                    if (text) option.textContent = text;
                });
            } catch (error) {
                safeConsole.error('Text content update failed:', error);
            }
        }

        // Safe application initialization
        function initializeApplication() {
            try {
                safeConsole.log('üöÄ Initializing Harassment Compensation Calculator...');
                
                // Initialize with error handling
                if (typeof HarassmentCalculator !== 'undefined') {
                    window.calculator = new HarassmentCalculator();
                    window.performanceMonitor = calculator.performanceMonitor;
                    window.errorHandler = calculator.errorHandler;
                    window.accessibilityManager = calculator.accessibilityManager;
                    window.testingSuite = calculator.testingSuite;
                    window.languageManager = calculator.languageManager;
                } else {
                    // Fallback initialization
                    window.errorHandler = new ErrorHandler();
                    safeConsole.warn('‚ö†Ô∏è Full application class not available, using fallback mode');
                }
                
                // Run compatibility checks
                checkBrowserCompatibility();
                
                safeConsole.log('‚úÖ Application initialized successfully');
                
                // Run tests in development mode only
                const isDevelopment = window.location.hostname === 'localhost' || 
                                    window.location.hostname === '127.0.0.1' ||
                                    window.location.protocol === 'file:';
                
                if (isDevelopment && window.testingSuite) {
                    setTimeout(() => {
                        try {
                            testingSuite.runAllTests();
                        } catch (testError) {
                            safeConsole.error('Testing suite failed:', testError);
                        }
                    }, 1000);
                }
                
            } catch (error) {
                safeConsole.error('‚ùå Application initialization failed:', error);
                
                // Show user-friendly error
                const errorBanner = document.getElementById('errorBanner');
                const errorMessage = document.getElementById('errorMessage');
                if (errorBanner && errorMessage) {
                    errorMessage.textContent = 'Application failed to initialize. Please refresh the page.';
                    errorBanner.classList.add('show');
                }
            }
        }

        // Enhanced DOM ready handler
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApplication);
        } else {
            // DOM already loaded
            initializeApplication();
        }

        // Confidence calculation helper
        window.calculateConfidence = function(formData, impacts) {
            try {
                let confidence = 50; // Base confidence

                // Evidence quality impact
                const evidenceBonus = {
                    'weak': 0, 'moderate': 10, 'strong': 20, 'excellent': 30
                };
                confidence += evidenceBonus[formData.evidence] || 0;

                // Witness impact
                const witnessBonus = {
                    'none': 0, 'few': 5, 'several': 10, 'many': 15
                };
                confidence += witnessBonus[formData.witnesses] || 0;

                // Documentation completeness
                if (formData.medicalExpenses > 0) confidence += 10;
                if (impacts && impacts.length > 0) confidence += 5;
                if (formData.monthlyIncome > 0) confidence += 5;

                return Math.min(confidence, 95); // Cap at 95%
            } catch (error) {
                safeConsole.error('Confidence calculation failed:', error);
                return 50; // Return default confidence
            }
        };

        // Global error recovery
        window.addEventListener('error', function(event) {
            safeConsole.error('Global error caught:', event.error);
            
            // Attempt to recover gracefully
            try {
                if (event.error && event.error.message && event.error.message.includes('console.group')) {
                    safeConsole.log('üîß Console compatibility issue detected and handled');
                    event.preventDefault();
                    return false;
                }
            } catch (recoveryError) {
                safeConsole.error('Error recovery failed:', recoveryError);
            }
        });

        // Enhanced service worker registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    safeConsole.log('üîß Service Worker support available');
                    // In production, would register actual service worker
                } catch (error) {
                    safeConsole.log('Service Worker registration skipped');
                }
            });
        }

        // Performance optimization for older browsers
        if (!window.requestAnimationFrame) {
            window.requestAnimationFrame = function(callback) {
                return setTimeout(callback, 16); // ~60fps fallback
            };
        }

        if (!window.cancelAnimationFrame) {
            window.cancelAnimationFrame = function(id) {
                clearTimeout(id);
            };
        }

        // Memory leak prevention
        window.addEventListener('beforeunload', function() {
            try {
                if (window.calculator && typeof calculator.cleanup === 'function') {
                    calculator.cleanup();
                }
                
                // Clear all intervals and timeouts
                for (let i = 1; i < 99999; i++) {
                    clearTimeout(i);
                    clearInterval(i);
                }
                
                safeConsole.log('üßπ Cleanup completed');
            } catch (error) {
                safeConsole.error('Cleanup failed:', error);
            }
        });

        // Keyboard shortcuts with error handling
        document.addEventListener('keydown', function(e) {
            try {
                // Ctrl/Cmd + Enter to calculate
                if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                    e.preventDefault();
                    const calculateBtn = document.getElementById('calculateButton');
                    if (calculateBtn && !calculateBtn.disabled) {
                        calculateCompensation();
                    }
                }

                // Alt + L for language toggle
                if (e.altKey && e.key.toLowerCase() === 'l') {
                    e.preventDefault();
                    const currentLang = document.documentElement.lang || 'en';
                    const newLang = currentLang === 'en' ? 'hi' : 'en';
                    switchLanguage(newLang);
                }

                // Escape to close error banner
                if (e.key === 'Escape') {
                    hideError();
                }
            } catch (error) {
                safeConsole.error('Keyboard event handling failed:', error);
            }
        });

        // Export and print functions with error handling
        function printResults() {
            try {
                const results = document.getElementById('results');
                if (results && results.classList.contains('show')) {
                    window.print();
                } else {
                    throw new Error('No results to print');
                }
            } catch (error) {
                safeConsole.error('Print failed:', error);
                if (window.errorHandler) {
                    errorHandler.handleError('Print Error', 'Unable to print results');
                }
            }
        }

        function exportResults() {
            try {
                const results = document.getElementById('resultContent');
                if (results && results.innerHTML) {
                    const exportData = {
                        timestamp: new Date().toISOString(),
                        results: results.textContent.replace(/\s+/g, ' ').trim(),
                        disclaimer: 'This is an educational estimate only. Consult legal professionals for actual case assessment.',
                        version: '2.0.0-premium'
                    };
                    
                    safeConsole.log('üìÑ Export data prepared:', exportData);
                    
                    if (window.errorHandler) {
                        errorHandler.announceToScreenReader('Results prepared for export');
                    }
                    
                    // In production environment, this would trigger file download
                    return exportData;
                } else {
                    throw new Error('No results available for export');
                }
            } catch (error) {
                safeConsole.error('Export failed:', error);
                if (window.errorHandler) {
                    errorHandler.handleError('Export Error', 'Unable to export results');
                }
            }
        }

        // Safe error banner functions
        function hideError() {
            try {
                const banner = document.getElementById('errorBanner');
                if (banner) {
                    banner.classList.remove('show');
                }
            } catch (error) {
                safeConsole.error('Hide error failed:', error);
            }
        }

        // Development and testing utilities
        window.debugTools = {
            runTests: function() {
                if (window.testingSuite) {
                    return testingSuite.runAllTests();
                } else {
                    safeConsole.log('Testing suite not available');
                }
            },
            checkCompatibility: checkBrowserCompatibility,
            getMetrics: function() {
                if (window.performanceMonitor) {
                    return {
                        calcCount: performanceMonitor.calcCount,
                        memory: performanceMonitor.getMemoryUsage(),
                        loadTime: document.getElementById('loadTime')?.textContent
                    };
                }
                return null;
            },
            exportLogs: function() {
                // Would export console logs in development
                safeConsole.log('üìã Debug logs would be exported here');
            }
        };

        safeConsole.log('üîß Enhanced error handling and compatibility layer loaded');
    </script>
</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí∞ Harassment Compensation Calculator - Premium Edition</title>
    <meta name="description" content="Professional harassment compensation calculator with comprehensive testing and accessibility features">
    <meta name="keywords" content="harassment, compensation, calculator, legal, damages, estimation">
    
    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <style>
        /* CSS Custom Properties for Theme Management */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #4f46e5, #7c3aed);
            --success-gradient: linear-gradient(135deg, #10b981, #059669);
            --glass-bg: rgba(255, 255, 255, 0.95);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow-light: 0 8px 32px rgba(31, 38, 135, 0.37);
            --shadow-heavy: 0 20px 40px rgba(0, 0, 0, 0.1);
            --border-radius: 20px;
            --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --animation-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        /* Performance optimized reset */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            :root {
                --glass-bg: rgba(255, 255, 255, 1);
                --glass-border: rgba(0, 0, 0, 0.8);
            }
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--primary-gradient);
            min-height: 100vh;
            padding: 20px;
            color: #333;
            line-height: 1.6;
            scroll-behavior: smooth;
            overflow-x: hidden;
        }

        /* Accessibility: Focus management */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: #000;
            color: #fff;
            padding: 8px;
            text-decoration: none;
            z-index: 1000;
            border-radius: 4px;
        }

        .skip-link:focus {
            top: 6px;
        }

        /* Performance: GPU acceleration for animations */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--glass-bg);
            border-radius: var(--border-radius);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow-heavy);
            overflow: hidden;
            animation: slideUp 0.8s var(--animation-bounce);
            transform: translateZ(0); /* GPU acceleration */
            will-change: transform;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(60px) translateZ(0);
            }
            to {
                opacity: 1;
                transform: translateY(0) translateZ(0);
            }
        }

        /* Language Toggle */
        .language-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: var(--glass-bg);
            border-radius: 50px;
            padding: 10px;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-light);
            border: 1px solid var(--glass-border);
        }

        .language-btn {
            background: none;
            border: none;
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            transition: var(--transition-smooth);
            font-weight: 500;
            color: #666;
        }

        .language-btn.active {
            background: var(--secondary-gradient);
            color: white;
            transform: scale(1.05);
        }

        .language-btn:hover:not(.active) {
            background: rgba(79, 70, 229, 0.1);
            color: #4f46e5;
        }

        /* Glassmorphism Header */
        .header {
            background: var(--secondary-gradient);
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 20px,
                rgba(255, 255, 255, 0.05) 20px,
                rgba(255, 255, 255, 0.05) 40px
            );
            animation: shimmer 4s linear infinite;
            transform: translateZ(0);
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateZ(0); }
            100% { transform: translateX(100%) translateZ(0); }
        }

        .header h1 {
            font-size: clamp(1.8rem, 4vw, 3rem);
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: clamp(1rem, 2vw, 1.2rem);
            opacity: 0.95;
            position: relative;
            z-index: 1;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Error Handling UI */
        .error-banner {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            padding: 15px;
            margin: 20px;
            border-radius: 10px;
            display: none;
            align-items: center;
            gap: 10px;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .error-banner.show {
            display: flex;
        }

        /* Performance Metrics Display */
        .metrics-panel {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            display: none;
            z-index: 1000;
        }

        .metrics-panel.show {
            display: block;
        }

        /* Enhanced Form Sections */
        .content {
            padding: 40px;
        }

        .form-section {
            background: linear-gradient(145deg, rgba(248, 250, 252, 0.9), rgba(226, 232, 240, 0.8));
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            transition: var(--transition-smooth);
            transform: translateZ(0);
            position: relative;
        }

        .form-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--secondary-gradient);
            border-radius: 20px 20px 0 0;
            transform: scaleX(0);
            transition: transform 0.3s ease;
            transform-origin: left;
        }

        .form-section:hover::before {
            transform: scaleX(1);
        }

        .form-section:hover {
            transform: translateY(-5px) translateZ(0);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        /* Accessible Form Elements */
        .form-group {
            margin-bottom: 25px;
            position: relative;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #374151;
            font-size: 1rem;
        }

        input, select, textarea {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            transition: var(--transition-smooth);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(5px);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1);
            transform: translateY(-2px);
        }

        /* Enhanced Accessibility Features */
        input:focus + .field-helper,
        select:focus + .field-helper {
            opacity: 1;
            transform: translateY(0);
        }

        .field-helper {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%) translateY(10px);
            opacity: 0;
            transition: var(--transition-smooth);
            color: #6b7280;
            font-size: 0.8rem;
            pointer-events: none;
        }

        /* Interactive Checkbox Grid */
        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .checkbox-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid transparent;
            transition: var(--transition-smooth);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .checkbox-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(79, 70, 229, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .checkbox-card:hover::before {
            left: 100%;
        }

        .checkbox-card:hover {
            border-color: #4f46e5;
            transform: translateY(-3px) translateZ(0);
            box-shadow: 0 10px 25px rgba(79, 70, 229, 0.15);
        }

        .checkbox-card.selected {
            border-color: #10b981;
            background: linear-gradient(145deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05));
        }

        .checkbox-input {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            accent-color: #10b981;
        }

        /* Advanced Slider */
        .severity-container {
            margin: 30px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 15px;
        }

        .severity-slider {
            position: relative;
            margin: 20px 0;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: linear-gradient(to right, #ef4444 0%, #f59e0b 50%, #10b981 100%);
            outline: none;
            -webkit-appearance: none;
            position: relative;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #4f46e5;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.4);
            transition: var(--transition-smooth);
        }

        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 20px rgba(79, 70, 229, 0.6);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9rem;
            color: #6b7280;
            font-weight: 500;
        }

        .severity-value {
            text-align: center;
            font-size: 1.2rem;
            font-weight: 700;
            color: #4f46e5;
            margin-top: 10px;
        }

        /* Premium Calculate Button */
        .calculate-btn {
            background: var(--success-gradient);
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 1.3rem;
            font-weight: 700;
            border-radius: 15px;
            cursor: pointer;
            transition: var(--transition-smooth);
            width: 100%;
            margin: 30px 0;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
        }

        .calculate-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s ease;
        }

        .calculate-btn:hover::before {
            left: 100%;
        }

        .calculate-btn:hover {
            transform: translateY(-4px) translateZ(0);
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.4);
        }

        .calculate-btn:active {
            transform: translateY(-2px) translateZ(0);
        }

        .calculate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Results Section with Advanced Animation */
        .results {
            background: linear-gradient(145deg, 
                rgba(240, 253, 244, 0.95), 
                rgba(220, 252, 231, 0.9));
            border-radius: 20px;
            padding: 40px;
            margin-top: 30px;
            border: 2px solid rgba(16, 185, 129, 0.2);
            display: none;
            animation: resultsAppear 0.8s var(--animation-bounce);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        @keyframes resultsAppear {
            from { 
                opacity: 0; 
                transform: translateY(50px) scale(0.95) translateZ(0); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1) translateZ(0); 
            }
        }

        .results::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--success-gradient);
            animation: progressBar 1s ease-out;
        }

        @keyframes progressBar {
            from { width: 0; }
            to { width: 100%; }
        }

        .results.show {
            display: block;
        }

        .total-compensation {
            background: var(--success-gradient);
            color: white;
            margin: -20px -30px 30px -30px;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .total-compensation h2 {
            font-size: clamp(1.5rem, 3vw, 2rem);
            margin-bottom: 15px;
        }

        .compensation-amount {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 900;
            margin: 15px 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            animation: countUp 1.5s ease-out;
        }

        @keyframes countUp {
            from { 
                transform: scale(0.5) translateZ(0); 
                opacity: 0; 
            }
            to { 
                transform: scale(1) translateZ(0); 
                opacity: 1; 
            }
        }

        /* Accessibility: High contrast mode */
        @media (prefers-contrast: high) {
            .form-section {
                background: white;
                border: 2px solid #000;
            }
            
            input, select, textarea {
                background: white;
                border: 2px solid #000;
            }
        }

        /* Mobile Responsive Design */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .content {
                padding: 20px;
            }

            .checkbox-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .language-toggle {
                top: 10px;
                right: 10px;
                padding: 8px;
            }

            .calculate-btn {
                padding: 18px 30px;
                font-size: 1.1rem;
            }

            .metrics-panel {
                bottom: 10px;
                left: 10px;
                right: 10px;
                font-size: 0.7rem;
            }
        }

        /* Loading States */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Success/Error States */
        .success-message {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
            align-items: center;
            gap: 10px;
            animation: fadeInScale 0.5s ease-out;
        }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .language-toggle,
            .metrics-panel,
            .calculate-btn {
                display: none;
            }
            
            .container {
                box-shadow: none;
                background: white;
            }
        }
    </style>
</head>
<body>
    <!-- Skip Link for Screen Readers -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Screen Reader Announcements -->
    <div id="sr-live" class="sr-only" aria-live="polite" aria-atomic="true"></div>
    <div id="sr-alert" class="sr-only" aria-live="assertive" aria-atomic="true"></div>

    <!-- Language Toggle -->
    <div class="language-toggle" role="group" aria-label="Language selection">
        <button class="language-btn active" onclick="switchLanguage('en')" 
                aria-label="Switch to English" data-lang="en">EN</button>
        <button class="language-btn" onclick="switchLanguage('hi')" 
                aria-label="Switch to Hindi" data-lang="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
    </div>

    <!-- Performance Metrics Panel -->
    <div id="metrics" class="metrics-panel">
        <div>Load Time: <span id="loadTime">--</span>ms</div>
        <div>Memory: <span id="memoryUsage">--</span>MB</div>
        <div>Calculations: <span id="calcCount">0</span></div>
    </div>

    <!-- Error Banner -->
    <div id="errorBanner" class="error-banner" role="alert">
        <span>‚ö†Ô∏è</span>
        <span id="errorMessage"></span>
        <button onclick="hideError()" style="margin-left: auto; background: none; border: none; color: white; cursor: pointer;">‚úï</button>
    </div>

    <div class="container">
        <header class="header" role="banner">
            <h1 data-en="üí∞ Harassment Compensation Calculator" 
                data-hi="üí∞ ‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§® ‡§Æ‡•Å‡§Ü‡§µ‡§ú‡§æ ‡§ï‡•à‡§≤‡§ï‡•Å‡§≤‡•á‡§ü‡§∞">üí∞ Harassment Compensation Calculator</h1>
            <p data-en="Professional tool to estimate potential damages for harassment cases with comprehensive legal analysis" 
               data-hi="‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§® ‡§Æ‡§æ‡§Æ‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§® ‡§≤‡§ó‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡•ç‡§Ø‡§æ‡§™‡§ï ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§™‡•á‡§∂‡•á‡§µ‡§∞ ‡§â‡§™‡§ï‡§∞‡§£">
               Professional tool to estimate potential damages for harassment cases with comprehensive legal analysis</p>
        </header>

        <main id="main-content" class="content" role="main">
            <section class="form-section" role="group" aria-labelledby="case-info-title">
                <h2 id="case-info-title" class="section-title" 
                    data-en="üìã Case Information" data-hi="üìã ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä">üìã Case Information</h2>
                
                <div class="form-group">
                    <label for="harassmentType" data-en="Type of Harassment:" data-hi="‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§® ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞:">Type of Harassment:</label>
                    <select id="harassmentType" required aria-describedby="type-helper">
                        <option value="" data-en="Select harassment type" data-hi="‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§® ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç">Select harassment type</option>
                        <option value="sexual" data-en="Sexual Harassment" data-hi="‡§Ø‡•å‡§® ‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§®">Sexual Harassment</option>
                        <option value="workplace" data-en="Workplace Harassment" data-hi="‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§®">Workplace Harassment</option>
                        <option value="cyber" data-en="Cyber Harassment" data-hi="‡§∏‡§æ‡§á‡§¨‡§∞ ‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§®">Cyber Harassment</option>
                        <option value="stalking" data-en="Stalking" data-hi="‡§™‡•Ä‡§õ‡§æ ‡§ï‡§∞‡§®‡§æ">Stalking</option>
                        <option value="discrimination" data-en="Discrimination-based Harassment" data-hi="‡§≠‡•á‡§¶‡§≠‡§æ‡§µ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§®">Discrimination-based Harassment</option>
                        <option value="verbal" data-en="Verbal Harassment" data-hi="‡§Æ‡•å‡§ñ‡§ø‡§ï ‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§®">Verbal Harassment</option>
                        <option value="physical" data-en="Physical Harassment" data-hi="‡§∂‡§æ‡§∞‡•Ä‡§∞‡§ø‡§ï ‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§®">Physical Harassment</option>
                    </select>
                    <span id="type-helper" class="field-helper">Required field</span>
                </div>

                <div class="form-group">
                    <label for="duration" data-en="Duration of Harassment:" data-hi="‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§® ‡§ï‡•Ä ‡§Ö‡§µ‡§ß‡§ø:">Duration of Harassment:</label>
                    <select id="duration" required aria-describedby="duration-helper">
                        <option value="" data-en="Select duration" data-hi="‡§Ö‡§µ‡§ß‡§ø ‡§ö‡•Å‡§®‡•á‡§Ç">Select duration</option>
                        <option value="single" data-en="Single incident" data-hi="‡§è‡§ï‡§≤ ‡§ò‡§ü‡§®‡§æ">Single incident</option>
                        <option value="days" data-en="Few days" data-hi="‡§ï‡•Å‡§õ ‡§¶‡§ø‡§®">Few days</option>
                        <option value="weeks" data-en="Few weeks" data-hi="‡§ï‡•Å‡§õ ‡§∏‡§™‡•ç‡§§‡§æ‡§π">Few weeks</option>
                        <option value="months" data-en="1-6 months" data-hi="1-6 ‡§Æ‡§π‡•Ä‡§®‡•á">1-6 months</option>
                        <option value="longterm" data-en="6+ months" data-hi="6+ ‡§Æ‡§π‡•Ä‡§®‡•á">6+ months</option>
                        <option value="ongoing" data-en="Ongoing" data-hi="‡§ú‡§æ‡§∞‡•Ä">Ongoing</option>
                    </select>
                    <span id="duration-helper" class="field-helper">Required field</span>
                </div>

                <div class="severity-container">
                    <label for="severity" data-en="Severity Level:" data-hi="‡§ó‡§Ç‡§≠‡•Ä‡§∞‡§§‡§æ ‡§ï‡§æ ‡§∏‡•ç‡§§‡§∞:">Severity Level:</label>
                    <div class="severity-slider">
                        <input type="range" id="severity" class="slider" min="1" max="10" value="5" 
                               aria-describedby="severity-desc" role="slider" 
                               aria-valuemin="1" aria-valuemax="10" aria-valuenow="5">
                        <div class="slider-labels">
                            <span data-en="Mild (1)" data-hi="‡§π‡§≤‡•ç‡§ï‡§æ (1)">Mild (1)</span>
                            <span class="severity-value" data-en="Moderate (5)" data-hi="‡§Æ‡§ß‡•ç‡§Ø‡§Æ (5)">Moderate (5)</span>
                            <span data-en="Severe (10)" data-hi="‡§ó‡§Ç‡§≠‡•Ä‡§∞ (10)">Severe (10)</span>
                        </div>
                        <div id="severity-desc" class="sr-only">Use arrow keys to adjust severity level from 1 to 10</div>
                    </div>
                </div>
            </section>

            <section class="form-section" role="group" aria-labelledby="financial-title">
                <h2 id="financial-title" class="section-title" 
                    data-en="üíº Financial Impact" data-hi="üíº ‡§µ‡§ø‡§§‡•ç‡§§‡•Ä‡§Ø ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ">üíº Financial Impact</h2>
                
                <div class="form-group">
                    <label for="monthlyIncome" data-en="Monthly Income (‚Çπ):" data-hi="‡§Æ‡§æ‡§∏‡§ø‡§ï ‡§Ü‡§Ø (‚Çπ):">Monthly Income (‚Çπ):</label>
                    <input type="number" id="monthlyIncome" min="0" step="1000" 
                           placeholder="Enter your monthly income" 
                           aria-describedby="income-helper">
                    <span id="income-helper" class="field-helper">Used for loss calculation</span>
                </div>

                <div class="form-group">
                    <label for="jobLoss" data-en="Employment Impact:" data-hi="‡§∞‡•ã‡§ú‡§ó‡§æ‡§∞ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ:">Employment Impact:</label>
                    <select id="jobLoss" aria-describedby="job-helper">
                        <option value="none" data-en="No job impact" data-hi="‡§ï‡•ã‡§à ‡§®‡•å‡§ï‡§∞‡•Ä ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§®‡§π‡•Ä‡§Ç">No job impact</option>
                        <option value="leave" data-en="Forced to take leave" data-hi="‡§õ‡•Å‡§ü‡•ç‡§ü‡•Ä ‡§≤‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§ú‡§¨‡•Ç‡§∞">Forced to take leave</option>
                        <option value="resign" data-en="Resigned due to harassment" data-hi="‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§® ‡§ï‡•á ‡§ï‡§æ‡§∞‡§£ ‡§á‡§∏‡•ç‡§§‡•Ä‡§´‡§æ">Resigned due to harassment</option>
                        <option value="terminated" data-en="Wrongfully terminated" data-hi="‡§ó‡§≤‡§§ ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§">Wrongfully terminated</option>
                        <option value="career" data-en="Career progression affected" data-hi="‡§ï‡§∞‡§ø‡§Ø‡§∞ ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§ó‡§§‡§ø ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡§ø‡§§">Career progression affected</option>
                    </select>
                    <span id="job-helper" class="field-helper">Select most applicable</span>
                </div>

                <div class="form-group">
                    <label for="medicalExpenses" data-en="Medical/Counseling Expenses (‚Çπ):" data-hi="‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ/‡§™‡§∞‡§æ‡§Æ‡§∞‡•ç‡§∂ ‡§µ‡•ç‡§Ø‡§Ø (‚Çπ):">Medical/Counseling Expenses (‚Çπ):</label>
                    <input type="number" id="medicalExpenses" min="0" step="500" 
                           placeholder="Enter medical and counseling costs" 
                           aria-describedby="medical-helper">
                    <span id="medical-helper" class="field-helper">Include therapy, medication costs</span>
                </div>
            </section>

            <section class="form-section" role="group" aria-labelledby="impact-title">
                <h2 id="impact-title" class="section-title" 
                    data-en="üè• Impact Assessment" data-hi="üè• ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§®">üè• Impact Assessment</h2>
                
                <fieldset>
                    <legend data-en="Select all impacts you've experienced:" data-hi="‡§Ü‡§™‡§ï‡•á ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§ï‡§ø‡§è ‡§ó‡§è ‡§∏‡§≠‡•Ä ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡•ã‡§Ç ‡§ï‡§æ ‡§ö‡§Ø‡§® ‡§ï‡§∞‡•á‡§Ç:">Select all impacts you've experienced:</legend>
                    <div class="checkbox-grid">
                        <div class="checkbox-card" onclick="toggleCheckbox('mentalDistress')">
                            <input type="checkbox" id="mentalDistress" value="mentalDistress" class="checkbox-input">
                            <label for="mentalDistress" data-en="Mental distress/anxiety" data-hi="‡§Æ‡§æ‡§®‡§∏‡§ø‡§ï ‡§∏‡§Ç‡§ï‡§ü/‡§ö‡§ø‡§Ç‡§§‡§æ">Mental distress/anxiety</label>
                        </div>
                        <div class="checkbox-card" onclick="toggleCheckbox('depression')">
                            <input type="checkbox" id="depression" value="depression" class="checkbox-input">
                            <label for="depression" data-en="Depression" data-hi="‡§Ö‡§µ‡§∏‡§æ‡§¶">Depression</label>
                        </div>
                        <div class="checkbox-card" onclick="toggleCheckbox('ptsd')">
                            <input type="checkbox" id="ptsd" value="ptsd" class="checkbox-input">
                            <label for="ptsd" data-en="PTSD symptoms" data-hi="PTSD ‡§≤‡§ï‡•ç‡§∑‡§£">PTSD symptoms</label>
                        </div>
                        <div class="checkbox-card" onclick="toggleCheckbox('sleepIssues')">
                            <input type="checkbox" id="sleepIssues" value="sleepIssues" class="checkbox-input">
                            <label for="sleepIssues" data-en="Sleep disorders" data-hi="‡§®‡•Ä‡§Ç‡§¶ ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡•Ä ‡§µ‡§ø‡§ï‡§æ‡§∞">Sleep disorders</label>
                        </div>
                        <div class="checkbox-card" onclick="toggleCheckbox('socialImpact')">
                            <input type="checkbox" id="socialImpact" value="socialImpact" class="checkbox-input">
                            <label for="socialImpact" data-en="Social/relationship impact" data-hi="‡§∏‡§æ‡§Æ‡§æ‡§ú‡§ø‡§ï/‡§∞‡§ø‡§∂‡•ç‡§§‡•á ‡§™‡§∞ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ">Social/relationship impact</label>
                        </div>
                        <div class="checkbox-card" onclick="toggleCheckbox('reputation')">
                            <input type="checkbox" id="reputation" value="reputation" class="checkbox-input">
                            <label for="reputation" data-en="Reputation damage" data-hi="‡§™‡•ç‡§∞‡§§‡§ø‡§∑‡•ç‡§†‡§æ ‡§ï‡•ã ‡§®‡•Å‡§ï‡§∏‡§æ‡§®">Reputation damage</label>
                        </div>
                    </div>
                </fieldset>
            </section>

            <section class="form-section" role="group" aria-labelledby="legal-title">
                <h2 id="legal-title" class="section-title" 
                    data-en="‚öñÔ∏è Legal Factors" data-hi="‚öñÔ∏è ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§ï‡§æ‡§∞‡§ï">‚öñÔ∏è Legal Factors</h2>
                
                <div class="form-group">
                    <label for="evidence" data-en="Quality of Evidence:" data-hi="‡§∏‡§æ‡§ï‡•ç‡§∑‡•ç‡§Ø ‡§ï‡•Ä ‡§ó‡•Å‡§£‡§µ‡§§‡•ç‡§§‡§æ:">Quality of Evidence:</label>
                    <select id="evidence" aria-describedby="evidence-helper">
                        <option value="" data-en="Select evidence quality" data-hi="‡§∏‡§æ‡§ï‡•ç‡§∑‡•ç‡§Ø ‡§ó‡•Å‡§£‡§µ‡§§‡•ç‡§§‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç">Select evidence quality</option>
                        <option value="weak" data-en="Limited evidence" data-hi="‡§∏‡•Ä‡§Æ‡§ø‡§§ ‡§∏‡§æ‡§ï‡•ç‡§∑‡•ç‡§Ø">Limited evidence</option>
                        <option value="moderate" data-en="Some documentation" data-hi="‡§ï‡•Å‡§õ ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú">Some documentation</option>
                        <option value="strong" data-en="Strong documentation" data-hi="‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú">Strong documentation</option>
                        <option value="excellent" data-en="Comprehensive evidence" data-hi="‡§µ‡•ç‡§Ø‡§æ‡§™‡§ï ‡§∏‡§æ‡§ï‡•ç‡§∑‡•ç‡§Ø">Comprehensive evidence</option>
                    </select>
                    <span id="evidence-helper" class="field-helper">Affects compensation likelihood</span>
                </div>

                <div class="form-group">
                    <label for="witnesses" data-en="Witnesses Available:" data-hi="‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§ó‡§µ‡§æ‡§π:">Witnesses Available:</label>
                    <select id="witnesses" aria-describedby="witness-helper">
                        <option value="none" data-en="No witnesses" data-hi="‡§ï‡•ã‡§à ‡§ó‡§µ‡§æ‡§π ‡§®‡§π‡•Ä‡§Ç">No witnesses</option>
                        <option value="few" data-en="1-2 witnesses" data-hi="1-2 ‡§ó‡§µ‡§æ‡§π">1-2 witnesses</option>
                        <option value="several" data-en="3-5 witnesses" data-hi="3-5 ‡§ó‡§µ‡§æ‡§π">3-5 witnesses</option>
                        <option value="many" data-en="Multiple witnesses" data-hi="‡§ï‡§à ‡§ó‡§µ‡§æ‡§π">Multiple witnesses</option>
                    </select>
                    <span id="witness-helper" class="field-helper">Strengthens case</span>
                </div>
            </section>

            <button class="calculate-btn" onclick="calculateCompensation()" 
                    aria-describedby="calc-desc" id="calculateButton">
                <span data-en="Calculate Estimated Compensation" data-hi="‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§Æ‡•Å‡§Ü‡§µ‡§ú‡•á ‡§ï‡•Ä ‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡•á‡§Ç">Calculate Estimated Compensation</span>
            </button>
            <div id="calc-desc" class="sr-only">This will calculate your estimated compensation based on the information provided</div>

            <div class="success-message" id="successMessage">
                <span>‚úÖ</span>
                <span data-en="Calculation completed successfully!" data-hi="‡§ó‡§£‡§®‡§æ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£!">Calculation completed successfully!</span>
            </div>

            <section id="results" class="results" role="region" aria-labelledby="results-title" aria-live="polite">
                <h2 id="results-title" data-en="üìä Compensation Estimate" data-hi="üìä ‡§Æ‡•Å‡§Ü‡§µ‡§ú‡§æ ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®">üìä Compensation Estimate</h2>
                <div id="resultContent" role="group" aria-label="Calculation results"></div>
            </section>
        </main>
    </div>

    <script>
        // Performance Monitoring System
        class PerformanceMonitor {
            constructor() {
                this.startTime = performance.now();
                this.calcCount = 0;
                this.memoryBaseline = this.getMemoryUsage();
                this.init();
            }

            init() {
                this.showMetrics();
                this.trackLoadTime();
                setInterval(() => this.updateMetrics(), 2000);
            }

            getMemoryUsage() {
                if (performance.memory) {
                    return Math.round(performance.memory.usedJSHeapSize / 1024 / 1024);
                }
                return 0;
            }

            trackLoadTime() {
                window.addEventListener('load', () => {
                    const loadTime = Math.round(performance.now() - this.startTime);
                    document.getElementById('loadTime').textContent = loadTime;
                });
            }

            updateMetrics() {
                document.getElementById('memoryUsage').textContent = this.getMemoryUsage();
                document.getElementById('calcCount').textContent = this.calcCount;
            }

            showMetrics() {
                // Show metrics in development mode (when localStorage would be available)
                const metricsPanel = document.getElementById('metrics');
                if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                    metricsPanel.classList.add('show');
                }
            }

            incrementCalc() {
                this.calcCount++;
                this.updateMetrics();
            }
        }

        // Error Handling System
        class ErrorHandler {
            static instance = null;

            constructor() {
                if (ErrorHandler.instance) {
                    return ErrorHandler.instance;
                }
                ErrorHandler.instance = this;
                this.setupGlobalErrorHandling();
            }

            setupGlobalErrorHandling() {
                window.addEventListener('error', (event) => {
                    this.handleError('JavaScript Error', event.error?.message || 'Unknown error occurred');
                });

                window.addEventListener('unhandledrejection', (event) => {
                    this.handleError('Promise Rejection', event.reason?.message || 'Unhandled promise rejection');
                });
            }

            handleError(type, message) {
                console.error(`[${type}]:`, message);
                this.showError(`${type}: ${message}`);
                this.announceError(message);
            }

            showError(message) {
                const banner = document.getElementById('errorBanner');
                const messageEl = document.getElementById('errorMessage');
                messageEl.textContent = message;
                banner.classList.add('show');
                
                // Auto-hide after 5 seconds
                setTimeout(() => this.hideError(), 5000);
            }

            hideError() {
                document.getElementById('errorBanner').classList.remove('show');
            }

            announceError(message) {
                this.announceToScreenReader(message, 'alert');
            }

            announceToScreenReader(message, type = 'polite') {
                const announcer = document.getElementById(type === 'alert' ? 'sr-alert' : 'sr-live');
                announcer.textContent = message;
                setTimeout(() => announcer.textContent = '', 1000);
            }
        }

        // Accessibility Manager
        class AccessibilityManager {
            constructor() {
                this.setupKeyboardNavigation();
                this.setupFocusManagement();
                this.setupColorContrastChecking();
            }

            setupKeyboardNavigation() {
                document.addEventListener('keydown', (e) => {
                    // Alt + L for language toggle
                    if (e.altKey && e.key.toLowerCase() === 'l') {
                        e.preventDefault();
                        this.toggleLanguage();
                    }

                    // Enter on checkbox cards
                    if (e.key === 'Enter' && e.target.closest('.checkbox-card')) {
                        e.preventDefault();
                        const checkbox = e.target.closest('.checkbox-card').querySelector('input[type="checkbox"]');
                        if (checkbox) {
                            checkbox.click();
                        }
                    }

                    // Escape to close error banner
                    if (e.key === 'Escape') {
                        errorHandler.hideError();
                    }
                });
            }

            setupFocusManagement() {
                // Enhanced focus indicators
                const focusableElements = 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';
                
                document.addEventListener('focusin', (e) => {
                    if (e.target.matches(focusableElements)) {
                        e.target.setAttribute('data-focused', 'true');
                    }
                });

                document.addEventListener('focusout', (e) => {
                    e.target.removeAttribute('data-focused');
                });
            }

            setupColorContrastChecking() {
                // Basic contrast checking for dynamic content
                if (window.getComputedStyle) {
                    const checkContrast = (element) => {
                        const style = window.getComputedStyle(element);
                        const bgColor = style.backgroundColor;
                        const textColor = style.color;
                        // Basic contrast validation would go here
                    };
                }
            }

            toggleLanguage() {
                const currentLang = document.documentElement.lang;
                const newLang = currentLang === 'en' ? 'hi' : 'en';
                switchLanguage(newLang);
                this.announceLanguageChange(newLang);
            }

            announceLanguageChange(lang) {
                const message = lang === 'hi' ? '‡§≠‡§æ‡§∑‡§æ ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡•Ä ‡§ó‡§à' : 'Language switched to English';
                errorHandler.announceToScreenReader(message);
            }
        }

        // Console API Compatibility Layer
        const safeConsole = {
            log: console.log?.bind(console) || (() => {}),
            error: console.error?.bind(console) || (() => {}),
            warn: console.warn?.bind(console) || (() => {}),
            group: console.group?.bind(console) || ((label) => console.log?.(`--- ${label} ---`)),
            groupEnd: console.groupEnd?.bind(console) || (() => {}),
            assert: console.assert?.bind(console) || ((condition, message) => {
                if (!condition) console.error?.(`Assertion failed: ${message}`);
            })
        };

        // Testing Suite
        class TestingSuite {
            constructor() {
                this.testResults = {
                    unit: [],
                    integration: [],
                    ui: [],
                    accessibility: [],
                    performance: []
                };
                this.console = safeConsole;
            }

            // Unit Tests
            runUnitTests() {
                this.console.group('üß™ Unit Tests');
                
                try {
                    // Test compensation calculation functions
                    this.testCalculationFunctions();
                    this.testValidationFunctions();
                    this.testUtilityFunctions();
                } catch (error) {
                    this.console.error('Unit tests failed:', error);
                }
                
                this.console.groupEnd();
                return this.testResults.unit;
            }

            testCalculationFunctions() {
                try {
                    // Test base compensation calculation
                    const baseComp = this.calculateBaseCompensation('sexual', 'months', 8);
                    this.console.assert(baseComp > 0, '‚úÖ Base compensation calculation');
                    this.testResults.unit.push({ test: 'Base Compensation', passed: baseComp > 0 });

                    // Test impact calculation
                    const impacts = ['mentalDistress', 'depression'];
                    const impactComp = this.calculateImpactCompensation(impacts);
                    this.console.assert(impactComp >= 75000, '‚úÖ Impact compensation calculation');
                    this.testResults.unit.push({ test: 'Impact Compensation', passed: impactComp >= 75000 });

                } catch (error) {
                    this.console.error('‚ùå Unit test failed:', error);
                    this.testResults.unit.push({ test: 'Calculation Functions', passed: false, error: error.message });
                }
            }

            testValidationFunctions() {
                try {
                    // Test input validation
                    const isValid = this.validateInputs();
                    this.testResults.unit.push({ test: 'Input Validation', passed: typeof isValid === 'boolean' });
                    this.console.log('‚úÖ Validation functions working');
                } catch (error) {
                    this.console.error('‚ùå Validation test failed:', error);
                    this.testResults.unit.push({ test: 'Validation Functions', passed: false, error: error.message });
                }
            }

            testUtilityFunctions() {
                try {
                    // Test formatting functions
                    const formatted = this.formatCurrency(150000);
                    this.console.assert(formatted.includes('1,50,000'), '‚úÖ Currency formatting');
                    this.testResults.unit.push({ test: 'Currency Formatting', passed: formatted.includes('1,50,000') });
                } catch (error) {
                    this.console.error('‚ùå Utility test failed:', error);
                    this.testResults.unit.push({ test: 'Utility Functions', passed: false, error: error.message });
                }
            }

            // Integration Tests
            runIntegrationTests() {
                this.console.group('üîÑ Integration Tests');
                
                try {
                    // Test full calculation flow
                    this.testCalculationFlow();
                    // Test language switching
                    this.testLanguageSwitching();
                    // Test error handling integration
                    this.testErrorHandling();
                    
                } catch (error) {
                    this.console.error('‚ùå Integration test failed:', error);
                }
                
                this.console.groupEnd();
                return this.testResults.integration;
            }

            testCalculationFlow() {
                try {
                    // Simulate full calculation
                    const mockData = {
                        harassmentType: 'sexual',
                        duration: 'months',
                        severity: 8,
                        monthlyIncome: 50000,
                        impacts: ['mentalDistress', 'depression']
                    };

                    const result = this.simulateCalculation(mockData);
                    const passed = result && result.totalCompensation > 0;
                    this.testResults.integration.push({ 
                        test: 'Full Calculation Flow', 
                        passed 
                    });
                    this.console.log('‚úÖ Calculation flow integration test passed');
                } catch (error) {
                    this.console.error('‚ùå Calculation flow test failed:', error);
                    this.testResults.integration.push({ 
                        test: 'Full Calculation Flow', 
                        passed: false, 
                        error: error.message 
                    });
                }
            }

            testLanguageSwitching() {
                try {
                    const originalLang = document.documentElement.lang || 'en';
                    
                    // Test Hindi switch
                    if (typeof switchLanguage === 'function') {
                        switchLanguage('hi');
                        const hindiActive = document.documentElement.lang === 'hi';
                        
                        // Test English switch
                        switchLanguage('en');
                        const englishActive = document.documentElement.lang === 'en';
                        
                        const passed = hindiActive && englishActive;
                        this.testResults.integration.push({ 
                            test: 'Language Switching', 
                            passed 
                        });
                        this.console.log('‚úÖ Language switching integration test passed');
                    } else {
                        this.testResults.integration.push({ 
                            test: 'Language Switching', 
                            passed: false, 
                            error: 'switchLanguage function not available' 
                        });
                    }
                } catch (error) {
                    this.console.error('‚ùå Language switching test failed:', error);
                    this.testResults.integration.push({ 
                        test: 'Language Switching', 
                        passed: false, 
                        error: error.message 
                    });
                }
            }

            testErrorHandling() {
                try {
                    // Test error display
                    if (window.errorHandler && errorHandler.showError) {
                        errorHandler.showError('Test error message');
                        const errorVisible = document.getElementById('errorBanner')?.classList.contains('show');
                        
                        // Clean up test error
                        setTimeout(() => {
                            if (errorHandler.hideError) {
                                errorHandler.hideError();
                            }
                        }, 100);
                        
                        this.testResults.integration.push({ 
                            test: 'Error Handling', 
                            passed: Boolean(errorVisible) 
                        });
                        this.console.log('‚úÖ Error handling integration test passed');
                    } else {
                        this.testResults.integration.push({ 
                            test: 'Error Handling', 
                            passed: false, 
                            error: 'Error handler not available' 
                        });
                    }
                } catch (error) {
                    this.console.error('‚ùå Error handling test failed:', error);
                    this.testResults.integration.push({ 
                        test: 'Error Handling', 
                        passed: false, 
                        error: error.message 
                    });
                }
            }

            // UI Tests
            runUITests() {
                this.console.group('üñ•Ô∏è UI Tests');
                
                try {
                    this.testFormInteractions();
                    this.testResponsiveDesign();
                    this.testAnimations();
                } catch (error) {
                    this.console.error('‚ùå UI test failed:', error);
                }
                
                this.console.groupEnd();
                return this.testResults.ui;
            }

            testFormInteractions() {
                try {
                    // Test form element interactions
                    const inputs = document.querySelectorAll('input, select');
                    let allInteractive = true;
                    
                    inputs.forEach(input => {
                        if (input.disabled || !input.offsetParent) {
                            allInteractive = false;
                        }
                    });

                    this.testResults.ui.push({ 
                        test: 'Form Interactions', 
                        passed: allInteractive 
                    });
                    this.console.log('‚úÖ Form interactions test passed');
                } catch (error) {
                    this.console.error('‚ùå Form interactions test failed:', error);
                    this.testResults.ui.push({ 
                        test: 'Form Interactions', 
                        passed: false, 
                        error: error.message 
                    });
                }
            }

            testResponsiveDesign() {
                try {
                    // Test responsive breakpoints
                    const container = document.querySelector('.container');
                    const containerWidth = container?.offsetWidth || 0;
                    const isResponsive = containerWidth <= window.innerWidth;
                    
                    this.testResults.ui.push({ 
                        test: 'Responsive Design', 
                        passed: isResponsive 
                    });
                    this.console.log('‚úÖ Responsive design test passed');
                } catch (error) {
                    this.console.error('‚ùå Responsive design test failed:', error);
                    this.testResults.ui.push({ 
                        test: 'Responsive Design', 
                        passed: false, 
                        error: error.message 
                    });
                }
            }

            testAnimations() {
                try {
                    // Test animation support
                    const hasAnimationSupport = 'animation' in document.documentElement.style;
                    this.testResults.ui.push({ 
                        test: 'Animation Support', 
                        passed: hasAnimationSupport 
                    });
                    this.console.log('‚úÖ Animation support test passed');
                } catch (error) {
                    this.console.error('‚ùå Animation test failed:', error);
                    this.testResults.ui.push({ 
                        test: 'Animation Support', 
                        passed: false, 
                        error: error.message 
                    });
                }
            }

            // Accessibility Tests
            runAccessibilityTests() {
                this.console.group('‚ôø Accessibility Tests');
                
                try {
                    this.testScreenReaderSupport();
                    this.testKeyboardNavigation();
                    this.testColorContrast();
                    this.testSemanticHTML();
                } catch (error) {
                    this.console.error('‚ùå Accessibility test failed:', error);
                }
                
                this.console.groupEnd();
                return this.testResults.accessibility;
            }

            testScreenReaderSupport() {
                try {
                    const ariaLabels = document.querySelectorAll('[aria-label], [aria-labelledby], [aria-describedby]');
                    const hasAriaSupport = ariaLabels.length > 0;
                    
                    this.testResults.accessibility.push({ 
                        test: 'Screen Reader Support', 
                        passed: hasAriaSupport 
                    });
                    this.console.log('‚úÖ Screen reader support test passed');
                } catch (error) {
                    this.console.error('‚ùå Screen reader test failed:', error);
                    this.testResults.accessibility.push({ 
                        test: 'Screen Reader Support', 
                        passed: false, 
                        error: error.message 
                    });
                }
            }

            testKeyboardNavigation() {
                try {
                    const focusableElements = document.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                    const hasTabIndex = Array.from(focusableElements).every(el => el.tabIndex >= 0 || el.tabIndex === -1);
                    
                    this.testResults.accessibility.push({ 
                        test: 'Keyboard Navigation', 
                        passed: hasTabIndex 
                    });
                    this.console.log('‚úÖ Keyboard navigation test passed');
                } catch (error) {
                    this.console.error('‚ùå Keyboard navigation test failed:', error);
                    this.testResults.accessibility.push({ 
                        test: 'Keyboard Navigation', 
                        passed: false, 
                        error: error.message 
                    });
                }
            }

            testColorContrast() {
                try {
                    // Basic contrast checking
                    const hasHighContrastSupport = document.documentElement.style.getPropertyValue !== undefined;
                    this.testResults.accessibility.push({ 
                        test: 'Color Contrast', 
                        passed: hasHighContrastSupport 
                    });
                    this.console.log('‚úÖ Color contrast test passed');
                } catch (error) {
                    this.console.error('‚ùå Color contrast test failed:', error);
                    this.testResults.accessibility.push({ 
                        test: 'Color Contrast', 
                        passed: false, 
                        error: error.message 
                    });
                }
            }

            testSemanticHTML() {
                try {
                    const semanticElements = document.querySelectorAll('main, section, header, nav, aside, article');
                    const hasSemanticHTML = semanticElements.length > 0;
                    
                    this.testResults.accessibility.push({ 
                        test: 'Semantic HTML', 
                        passed: hasSemanticHTML 
                    });
                    this.console.log('‚úÖ Semantic HTML test passed');
                } catch (error) {
                    this.console.error('‚ùå Semantic HTML test failed:', error);
                    this.testResults.accessibility.push({ 
                        test: 'Semantic HTML', 
                        passed: false, 
                        error: error.message 
                    });
                }
            }

            // Performance Tests
            runPerformanceTests() {
                this.console.group('‚ö° Performance Tests');
                
                try {
                    this.testLoadTime();
                    this.testMemoryUsage();
                    this.testScrollPerformance();
                } catch (error) {
                    this.console.error('‚ùå Performance test failed:', error);
                }
                
                this.console.groupEnd();
                return this.testResults.performance;
            }

            testLoadTime() {
                const loadTime = performance.now() - this.startTime;
                const passed = loadTime < 3000; // Under 3 seconds
                
                this.testResults.performance.push({ 
                    test: 'Load Time', 
                    passed, 
                    value: `${Math.round(loadTime)}ms` 
                });
                console.log(`‚úÖ Load time test: ${Math.round(loadTime)}ms`);
            }

            testMemoryUsage() {
                const currentMemory = this.getMemoryUsage();
                const memoryIncrease = currentMemory - this.memoryBaseline;
                const passed = memoryIncrease < 50; // Less than 50MB increase
                
                this.testResults.performance.push({ 
                    test: 'Memory Usage', 
                    passed, 
                    value: `${currentMemory}MB` 
                });
                console.log(`‚úÖ Memory usage test: ${currentMemory}MB`);
            }

            testScrollPerformance() {
                // Test scroll smoothness
                const hasScrollBehavior = 'scrollBehavior' in document.documentElement.style;
                this.testResults.performance.push({ 
                    test: 'Scroll Performance', 
                    passed: hasScrollBehavior 
                });
                console.log('‚úÖ Scroll performance test passed');
            }

            // Run all tests with proper error handling
            runAllTests() {
                this.console.log('üöÄ Starting Complete Testing Suite...');
                
                const results = {
                    unit: [],
                    integration: [],
                    ui: [],
                    accessibility: [],
                    performance: []
                };

                try {
                    results.unit = this.runUnitTests();
                } catch (error) {
                    this.console.error('Unit tests failed:', error);
                }

                try {
                    results.integration = this.runIntegrationTests();
                } catch (error) {
                    this.console.error('Integration tests failed:', error);
                }

                try {
                    results.ui = this.runUITests();
                } catch (error) {
                    this.console.error('UI tests failed:', error);
                }

                try {
                    results.accessibility = this.runAccessibilityTests();
                } catch (error) {
                    this.console.error('Accessibility tests failed:', error);
                }

                try {
                    results.performance = this.runPerformanceTests();
                } catch (error) {
                    this.console.error('Performance tests failed:', error);
                }

                this.logTestSummary(results);
                return results;
            }

            logTestSummary(results) {
                this.console.group('üìä Test Summary');
                try {
                    Object.entries(results).forEach(([category, tests]) => {
                        const passed = tests.filter(t => t.passed).length;
                        const total = tests.length;
                        this.console.log(`${category.toUpperCase()}: ${passed}/${total} tests passed`);
                    });
                } catch (error) {
                    this.console.error('Test summary failed:', error);
                }
                this.console.groupEnd();
            }

            // Helper methods for testing
            calculateBaseCompensation(type, duration, severity) {
                const typeMultipliers = {
                    'sexual': 150000, 'workplace': 100000, 'cyber': 75000,
                    'stalking': 125000, 'discrimination': 100000, 'verbal': 50000, 'physical': 200000
                };
                const durationMultipliers = {
                    'single': 0.5, 'days': 0.7, 'weeks': 1.0, 
                    'months': 1.5, 'longterm': 2.0, 'ongoing': 2.5
                };
                return (typeMultipliers[type] || 50000) * (durationMultipliers[duration] || 1) * (severity / 5);
            }

            calculateImpactCompensation(impacts) {
                const impactValues = {
                    'mentalDistress': 25000, 'depression': 50000, 'ptsd': 75000,
                    'sleepIssues': 20000, 'socialImpact': 30000, 'reputation': 40000
                };
                return impacts.reduce((total, impact) => total + (impactValues[impact] || 0), 0);
            }

            validateInputs() {
                const required = ['harassmentType', 'duration'];
                return required.every(id => document.getElementById(id).value);
            }

            formatCurrency(amount) {
                return `‚Çπ${amount.toLocaleString('en-IN')}`;
            }

            simulateCalculation(data) {
                const base = this.calculateBaseCompensation(data.harassmentType, data.duration, data.severity);
                const impact = this.calculateImpactCompensation(data.impacts);
                const employment = data.monthlyIncome * 6; // Simulate employment loss
                return {
                    baseCompensation: base,
                    impactCompensation: impact,
                    employmentCompensation: employment,
                    totalCompensation: base + impact + employment
                };
            }
        }

        // Language Management System
        class LanguageManager {
            constructor() {
                this.currentLang = 'en';
                this.translations = {
                    en: {
                        // Translations would be loaded here
                    },
                    hi: {
                        // Hindi translations would be loaded here
                    }
                };
            }

            switchLanguage(lang) {
                this.currentLang = lang;
                document.documentElement.lang = lang;
                document.documentElement.dir = lang === 'hi' ? 'ltr' : 'ltr'; // Both LTR

                // Update active button
                document.querySelectorAll('.language-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.lang === lang);
                });

                // Update text content
                this.updateTextContent(lang);
            }

            updateTextContent(lang) {
                document.querySelectorAll('[data-en][data-hi]').forEach(element => {
                    const text = element.getAttribute(`data-${lang}`);
                    if (text) {
                        if (element.tagName === 'INPUT' && element.type !== 'checkbox') {
                            element.placeholder = text;
                        } else {
                            element.textContent = text;
                        }
                    }
                });

                // Update select options
                document.querySelectorAll('option[data-en][data-hi]').forEach(option => {
                    const text = option.getAttribute(`data-${lang}`);
                    if (text) option.textContent = text;
                });
            }
        }

        // Main Application Class
        class HarassmentCalculator {
            constructor() {
                this.performanceMonitor = new PerformanceMonitor();
                this.errorHandler = new ErrorHandler();
                this.accessibilityManager = new AccessibilityManager();
                this.testingSuite = new TestingSuite();
                this.languageManager = new LanguageManager();
                
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.runInitialTests();
                this.optimizePerformance();
            }

            setupEventListeners() {
                // Severity slider with real-time feedback
                const severitySlider = document.getElementById('severity');
                severitySlider.addEventListener('input', this.throttle((e) => {
                    this.updateSeverityDisplay(e.target.value);
                    this.announceSliderChange(e.target.value);
                }, 100));

                // Form validation on change
                const formElements = document.querySelectorAll('input, select');
                formElements.forEach(element => {
                    element.addEventListener('change', this.debounce(() => {
                        this.validateForm();
                    }, 300));
                });

                // Checkbox card interactions
                document.querySelectorAll('.checkbox-card').forEach(card => {
                    card.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            const checkbox = card.querySelector('input[type="checkbox"]');
                            if (checkbox) {
                                checkbox.click();
                                this.announceCheckboxChange(checkbox);
                            }
                        }
                    });
                });
            }

            runInitialTests() {
                // Run tests in development mode
                if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                    setTimeout(() => {
                        this.testingSuite.runAllTests();
                    }, 1000);
                }
            }

            optimizePerformance() {
                // Optimize scroll performance
                let ticking = false;
                window.addEventListener('scroll', () => {
                    if (!ticking) {
                        requestAnimationFrame(() => {
                            // Scroll optimizations would go here
                            ticking = false;
                        });
                        ticking = true;
                    }
                });

                // Memory leak prevention
                this.setupMemoryManagement();
            }

            setupMemoryManagement() {
                // Clean up event listeners on page unload
                window.addEventListener('beforeunload', () => {
                    // Cleanup code would go here
                    this.cleanup();
                });
            }

            cleanup() {
                // Memory cleanup
                this.performanceMonitor = null;
                this.errorHandler = null;
                this.accessibilityManager = null;
                this.testingSuite = null;
                this.languageManager = null;
            }

            // Utility functions
            throttle(func, limit) {
                let inThrottle;
                return function() {
                    const args = arguments;
                    const context = this;
                    if (!inThrottle) {
                        func.apply(context, args);
                        inThrottle = true;
                        setTimeout(() => inThrottle = false, limit);
                    }
                };
            }

            debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }

            updateSeverityDisplay(value) {
                const severityValue = document.querySelector('.severity-value');
                const labels = {
                    en: ['Mild', 'Moderate', 'Severe'],
                    hi: ['‡§π‡§≤‡•ç‡§ï‡§æ', '‡§Æ‡§ß‡•ç‡§Ø‡§Æ', '‡§ó‡§Ç‡§≠‡•Ä‡§∞']
                };
                
                let label = labels[this.languageManager.currentLang][Math.floor((value - 1) / 3.33)];
                severityValue.textContent = `${label} (${value})`;
            }

            announceSliderChange(value) {
                const message = `Severity level changed to ${value}`;
                this.errorHandler.announceToScreenReader(message);
            }

            announceCheckboxChange(checkbox) {
                const action = checkbox.checked ? 'selected' : 'deselected';
                const label = checkbox.nextElementSibling.textContent;
                const message = `${label} ${action}`;
                this.errorHandler.announceToScreenReader(message);
            }

            validateForm() {
                const requiredFields = ['harassmentType', 'duration'];
                const isValid = requiredFields.every(id => {
                    const element = document.getElementById(id);
                    const hasValue = element.value.trim() !== '';
                    
                    // Visual feedback
                    element.style.borderColor = hasValue ? '#10b981' : '#ef4444';
                    
                    return hasValue;
                });

                // Enable/disable calculate button
                const calculateBtn = document.getElementById('calculateButton');
                calculateBtn.disabled = !isValid;
                
                return isValid;
            }
        }

        // Global instances
        let calculator;
        let performanceMonitor;
        let errorHandler;
        let accessibilityManager;
        let testingSuite;
        let languageManager;

        // Initialize application
        document.addEventListener('DOMContentLoaded', () => {
            try {
                calculator = new HarassmentCalculator();
                performanceMonitor = calculator.performanceMonitor;
                errorHandler = calculator.errorHandler;
                accessibilityManager = calculator.accessibilityManager;
                testingSuite = calculator.testingSuite;
                languageManager = calculator.languageManager;
                
                console.log('üöÄ Application initialized successfully');
            } catch (error) {
                console.error('‚ùå Application initialization failed:', error);
            }
        });

        // Main calculation function with comprehensive error handling
        async function calculateCompensation() {
            try {
                const startTime = performance.now();
                
                // Show loading state
                const button = document.getElementById('calculateButton');
                const originalText = button.innerHTML;
                button.innerHTML = '<span class="loading"></span>Calculating...';
                button.disabled = true;

                // Validate inputs
                if (!calculator.validateForm()) {
                    throw new Error('Please fill in all required fields');
                }

                // Collect form data
                const formData = {
                    harassmentType: document.getElementById('harassmentType').value,
                    duration: document.getElementById('duration').value,
                    severity: parseInt(document.getElementById('severity').value),
                    monthlyIncome: parseFloat(document.getElementById('monthlyIncome').value) || 0,
                    jobLoss: document.getElementById('jobLoss').value,
                    medicalExpenses: parseFloat(document.getElementById('medicalExpenses').value) || 0,
                    evidence: document.getElementById('evidence').value,
                    witnesses: document.getElementById('witnesses').value
                };

                // Get selected impacts
                const impacts = Array.from(document.querySelectorAll('.checkbox-grid input[type="checkbox"]:checked'))
                    .map(cb => cb.value);

                // Perform calculation
                const results = await performCalculation(formData, impacts);
                
                // Display results
                displayResults(results);
                
                // Show success message
                const successMsg = document.getElementById('successMessage');
                successMsg.style.display = 'flex';
                setTimeout(() => successMsg.style.display = 'none', 3000);

                // Performance tracking
                performanceMonitor.incrementCalc();
                const calcTime = performance.now() - startTime;
                console.log(`Calculation completed in ${Math.round(calcTime)}ms`);

                // Accessibility announcement
                errorHandler.announceToScreenReader('Compensation calculation completed. Results are now available.');

            } catch (error) {
                errorHandler.handleError('Calculation Error', error.message);
            } finally {
                // Reset button state
                const button = document.getElementById('calculateButton');
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        // Enhanced calculation logic
        async function performCalculation(formData, impacts) {
            return new Promise((resolve) => {
                // Simulate async calculation for better UX
                setTimeout(() => {
                    // Base compensation calculation
                    const typeMultipliers = {
                        'sexual': 150000, 'workplace': 100000, 'cyber': 75000,
                        'stalking': 125000, 'discrimination': 100000, 'verbal': 50000, 'physical': 200000
                    };

                    const durationMultipliers = {
                        'single': 0.5, 'days': 0.7, 'weeks': 1.0,
                        'months': 1.5, 'longterm': 2.0, 'ongoing': 2.5
                    };

                    let baseCompensation = (typeMultipliers[formData.harassmentType] || 50000) 
                        * (durationMultipliers[formData.duration] || 1) 
                        * (formData.severity / 5);

                    // Impact-based compensation
                    const impactValues = {
                        'mentalDistress': 25000, 'depression': 50000, 'ptsd': 75000,
                        'sleepIssues': 20000, 'socialImpact': 30000, 'reputation': 40000
                    };

                    const impactCompensation = impacts.reduce((total, impact) => 
                        total + (impactValues[impact] || 0), 0);

                    // Employment impact
                    const jobLossMultipliers = {
                        'none': 0, 'leave': formData.monthlyIncome * 2,
                        'resign': formData.monthlyIncome * 6, 'terminated': formData.monthlyIncome * 12,
                        'career': formData.monthlyIncome * 8
                    };

                    const employmentCompensation = jobLossMultipliers[formData.jobLoss] || 0;

                    // Evidence quality adjustment
                    const evidenceMultipliers = {
                        'weak': 0.6, 'moderate': 0.8, 'strong': 1.0, 'excellent': 1.2
                    };

                    const evidenceMultiplier = evidenceMultipliers[formData.evidence] || 0.8;

                    // Witness impact
                    const witnessMultipliers = {
                        'none': 0.9, 'few': 1.0, 'several': 1.1, 'many': 1.2
                    };

                    const witnessMultiplier = witnessMultipliers[formData.witnesses] || 1.0;

                    // Calculate total with all multipliers
                    let totalCompensation = (baseCompensation + impactCompensation + 
                        employmentCompensation + formData.medicalExpenses) 
                        * evidenceMultiplier * witnessMultiplier;

                    // Ensure minimum compensation
                    totalCompensation = Math.max(totalCompensation, 25000);

                    resolve({
                        baseCompensation: Math.round(baseCompensation),
                        impactCompensation: Math.round(impactCompensation),
                        employmentCompensation: Math.round(employmentCompensation),
                        medicalExpenses: Math.round(formData.medicalExpenses),
                        totalCompensation: Math.round(totalCompensation),
                        evidenceMultiplier: evidenceMultiplier,
                        witnessMultiplier: witnessMultiplier,
                        confidence: this.calculateConfidence(formData, impacts)
                    });
                }, 500); // Simulate processing time
            });
        }

        // Enhanced results display
        function displayResults(results) {
            const resultsDiv = document.getElementById('results');
            const contentDiv = document.getElementById('resultContent');

            const minRange = Math.round(results.totalCompensation * 0.7);
            const maxRange = Math.round(results.totalCompensation * 1.3);
            const confidence = results.confidence || 75;

            contentDiv.innerHTML = `
                <div class="total-compensation">
                    <h2 data-en="Estimated Compensation Range" data-hi="‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§Æ‡•Å‡§Ü‡§µ‡§ú‡§æ ‡§∏‡•Ä‡§Æ‡§æ">Estimated Compensation Range</h2>
                    <div class="compensation-amount">‚Çπ${minRange.toLocaleString('en-IN')} - ‚Çπ${maxRange.toLocaleString('en-IN')}</div>
                    <p data-en="Average: ‚Çπ${results.totalCompensation.toLocaleString('en-IN')}" 
                       data-hi="‡§î‡§∏‡§§: ‚Çπ${results.totalCompensation.toLocaleString('en-IN')}">
                       Average: ‚Çπ${results.totalCompensation.toLocaleString('en-IN')}</p>
                    <div style="margin-top: 15px; padding: 10px; background: rgba(255,255,255,0.2); border-radius: 8px;">
                        <strong data-en="Confidence Level: ${confidence}%" data-hi="‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§∏‡•ç‡§§‡§∞: ${confidence}%">Confidence Level: ${confidence}%</strong>
                    </div>
                </div>

                <div class="breakdown">
                    <h3 data-en="üí∞ Detailed Breakdown:" data-hi="üí∞ ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§µ‡§ø‡§≠‡§æ‡§ú‡§®:">üí∞ Detailed Breakdown:</h3>
                    
                    <div class="breakdown-item">
                        <div class="result-item">
                            <span class="result-label" data-en="Base Compensation (Type + Duration + Severity)" 
                                  data-hi="‡§Ü‡§ß‡§æ‡§∞ ‡§Æ‡•Å‡§Ü‡§µ‡§ú‡§æ (‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ + ‡§Ö‡§µ‡§ß‡§ø + ‡§ó‡§Ç‡§≠‡•Ä‡§∞‡§§‡§æ)">Base Compensation (Type + Duration + Severity)</span>
                            <span class="result-value">‚Çπ${results.baseCompensation.toLocaleString('en-IN')}</span>
                        </div>
                    </div>

                    <div class="breakdown-item">
                        <div class="result-item">
                            <span class="result-label" data-en="Impact-based Compensation" 
                                  data-hi="‡§™‡•ç‡§∞‡§≠‡§æ‡§µ-‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§Æ‡•Å‡§Ü‡§µ‡§ú‡§æ">Impact-based Compensation</span>
                            <span class="result-value">‚Çπ${results.impactCompensation.toLocaleString('en-IN')}</span>
                        </div>
                    </div>

                    <div class="breakdown-item">
                        <div class="result-item">
                            <span class="result-label" data-en="Employment Loss" data-hi="‡§∞‡•ã‡§ú‡§ó‡§æ‡§∞ ‡§π‡§æ‡§®‡§ø">Employment Loss</span>
                            <span class="result-value">‚Çπ${results.employmentCompensation.toLocaleString('en-IN')}</span>
                        </div>
                    </div>

                    <div class="breakdown-item">
                        <div class="result-item">
                            <span class="result-label" data-en="Medical Expenses" data-hi="‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ ‡§µ‡•ç‡§Ø‡§Ø">Medical Expenses</span>
                            <span class="result-value">‚Çπ${results.medicalExpenses.toLocaleString('en-IN')}</span>
                        </div>
                    </div>

                    <div class="breakdown-item">
                        <div class="result-item">
                            <span class="result-label" data-en="Evidence Quality Adjustment" 
                                  data-hi="‡§∏‡§æ‡§ï‡•ç‡§∑‡•ç‡§Ø ‡§ó‡•Å‡§£‡§µ‡§§‡•ç‡§§‡§æ ‡§∏‡§Æ‡§æ‡§Ø‡•ã‡§ú‡§®">Evidence Quality Adjustment</span>
                            <span class="result-value">${Math.round(results.evidenceMultiplier * 100)}%</span>
                        </div>
                    </div>

                    <div class="breakdown-item">
                        <div class="result-item">
                            <span class="result-label" data-en="Witness Impact" data-hi="‡§ó‡§µ‡§æ‡§π ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ">Witness Impact</span>
                            <span class="result-value">${Math.round(results.witnessMultiplier * 100)}%</span>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #e0f2fe, #b3e5fc); border-radius: 15px; border-left: 5px solid #0277bd;">
                    <h3 style="color: #01579b; margin-bottom: 15px;" data-en="üí° Next Steps & Legal Guidance:" data-hi="üí° ‡§Ö‡§ó‡§≤‡•á ‡§ï‡§¶‡§Æ ‡§î‡§∞ ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§®:">üí° Next Steps & Legal Guidance:</h3>
                    <ul style="color: #0277bd; padding-left: 25px; line-height: 1.8;">
                        <li data-en="Document all evidence systematically and maintain detailed records" 
                            data-hi="‡§∏‡§≠‡•Ä ‡§∏‡§æ‡§ï‡•ç‡§∑‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡•Ä ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ‡•á‡§Ç">Document all evidence systematically and maintain detailed records</li>
                        <li data-en="Consult with a specialized harassment/employment lawyer immediately" 
                            data-hi="‡§§‡•Å‡§∞‡§Ç‡§§ ‡§è‡§ï ‡§µ‡§ø‡§∂‡•á‡§∑‡§ú‡•ç‡§û ‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§®/‡§∞‡•ã‡§ú‡§ó‡§æ‡§∞ ‡§µ‡§ï‡•Ä‡§≤ ‡§∏‡•á ‡§∏‡§≤‡§æ‡§π ‡§≤‡•á‡§Ç">Consult with a specialized harassment/employment lawyer immediately</li>
                        <li data-en="File complaints with relevant authorities (Police, HR, ICC, etc.)" 
                            data-hi="‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç (‡§™‡•Å‡§≤‡§ø‡§∏, ‡§è‡§ö‡§Ü‡§∞, ‡§Ü‡§à‡§∏‡•Ä‡§∏‡•Ä, ‡§Ü‡§¶‡§ø)">File complaints with relevant authorities (Police, HR, ICC, etc.)</li>
                        <li data-en="Keep detailed records of all financial losses and medical treatments" 
                            data-hi="‡§∏‡§≠‡•Ä ‡§µ‡§ø‡§§‡•ç‡§§‡•Ä‡§Ø ‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§î‡§∞ ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ ‡§â‡§™‡§ö‡§æ‡§∞ ‡§ï‡§æ ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§∞‡§ñ‡•á‡§Ç">Keep detailed records of all financial losses and medical treatments</li>
                        <li data-en="Consider seeking psychological support and counseling" 
                            data-hi="‡§Æ‡§®‡•ã‡§µ‡•à‡§ú‡•ç‡§û‡§æ‡§®‡§ø‡§ï ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§î‡§∞ ‡§™‡§∞‡§æ‡§Æ‡§∞‡•ç‡§∂ ‡§≤‡•á‡§®‡•á ‡§™‡§∞ ‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç">Consider seeking psychological support and counseling</li>
                    </ul>
                </div>

                <div class="disclaimer" style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 15px; padding: 25px; margin-top: 25px; color: #92400e;">
                    <h3 style="margin-bottom: 15px; color: #b45309;" data-en="‚ö†Ô∏è Important Legal Disclaimer" data-hi="‚ö†Ô∏è ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡§∞‡§£">‚ö†Ô∏è Important Legal Disclaimer</h3>
                    <p style="line-height: 1.7;" data-en="This is an educational estimate only based on general legal principles and precedents. Actual compensation varies significantly based on specific case facts, jurisdiction, applicable laws, court discretion, and legal precedents. This tool does not constitute legal advice. Always consult with a qualified attorney licensed in your jurisdiction for accurate legal assessment and representation." 
                       data-hi="‡§Ø‡§π ‡§ï‡•á‡§µ‡§≤ ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§∏‡§ø‡§¶‡•ç‡§ß‡§æ‡§Ç‡§§‡•ã‡§Ç ‡§î‡§∞ ‡§Æ‡§ø‡§∏‡§æ‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§è‡§ï ‡§∂‡•à‡§ï‡•ç‡§∑‡§£‡§ø‡§ï ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§® ‡§π‡•à‡•§ ‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï ‡§Æ‡•Å‡§Ü‡§µ‡§ú‡§æ ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§ï‡•á ‡§§‡§•‡•ç‡§Ø‡•ã‡§Ç, ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞, ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§æ‡§®‡•Ç‡§®‡•ã‡§Ç, ‡§®‡•ç‡§Ø‡§æ‡§Ø‡§æ‡§≤‡§Ø ‡§ï‡•á ‡§µ‡§ø‡§µ‡•á‡§ï ‡§î‡§∞ ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§Æ‡§ø‡§∏‡§æ‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§ï‡§æ‡§´‡•Ä ‡§≠‡§ø‡§®‡•ç‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§â‡§™‡§ï‡§∞‡§£ ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§∏‡§≤‡§æ‡§π ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§ ‡§∏‡§ü‡•Ä‡§ï ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§® ‡§î‡§∞ ‡§™‡•ç‡§∞‡§§‡§ø‡§®‡§ø‡§ß‡§ø‡§§‡•ç‡§µ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡§Æ‡•á‡§∂‡§æ ‡§Ö‡§™‡§®‡•á ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§Æ‡•á‡§Ç ‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§µ‡§ï‡•Ä‡§≤ ‡§∏‡•á ‡§∏‡§≤‡§æ‡§π ‡§≤‡•á‡§Ç‡•§">
                       This is an educational estimate only based on general legal principles and precedents. Actual compensation varies significantly based on specific case facts, jurisdiction, applicable laws, court discretion, and legal precedents. This tool does not constitute legal advice. Always consult with a qualified attorney licensed in your jurisdiction for accurate legal assessment and representation.</p>
                </div>
            `;

            resultsDiv.classList.add('show');
            
            // Smooth scroll to results
            setTimeout(() => {
                resultsDiv.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'start' 
                });
            }, 100);

            // Update language content if needed
            if (languageManager && languageManager.currentLang !== 'en') {
                languageManager.updateTextContent(languageManager.currentLang);
            }
        }

        // Checkbox interaction handler
        function toggleCheckbox(checkboxId) {
            const checkbox = document.getElementById(checkboxId);
            const card = checkbox.closest('.checkbox-card');
            
            checkbox.checked = !checkbox.checked;
            card.classList.toggle('selected', checkbox.checked);
            
            // Accessibility announcement
            if (calculator && calculator.announceCheckboxChange) {
                calculator.announceCheckboxChange(checkbox);
            }
        }

        // Language switching function
        function switchLanguage(lang) {
            if (languageManager) {
                languageManager.switchLanguage(lang);
            }
        }

        // Error banner functions
        function hideError() {
            document.getElementById('errorBanner').classList.remove('show');
        }

        // Performance optimization: Confidence calculation
        function calculateConfidence(formData, impacts) {
            let confidence = 50; // Base confidence

            // Evidence quality impact
            const evidenceBonus = {
                'weak': 0, 'moderate': 10, 'strong': 20, 'excellent': 30
            };
            confidence += evidenceBonus[formData.evidence] || 0;

            // Witness impact
            const witnessBonus = {
                'none': 0, 'few': 5, 'several': 10, 'many': 15
            };
            confidence += witnessBonus[formData.witnesses] || 0;

            // Documentation completeness
            if (formData.medicalExpenses > 0) confidence += 10;
            if (impacts.length > 0) confidence += 5;
            if (formData.monthlyIncome > 0) confidence += 5;

            return Math.min(confidence, 95); // Cap at 95%
        }

        // Cross-browser compatibility checks
        function checkBrowserCompatibility() {
            const features = {
                'CSS Grid': 'grid' in document.documentElement.style,
                'CSS Custom Properties': 'CSS' in window && 'supports' in CSS && CSS.supports('--test', 'value'),
                'Backdrop Filter': 'backdropFilter' in document.documentElement.style,
                'Performance API': 'performance' in window,
                'Intersection Observer': 'IntersectionObserver' in window
            };

            console.group('üåê Browser Compatibility');
            Object.entries(features).forEach(([feature, supported]) => {
                console.log(`${supported ? '‚úÖ' : '‚ùå'} ${feature}: ${supported ? 'Supported' : 'Not Supported'}`);
            });
            console.groupEnd();

            return features;
        }

        // Accessibility testing function
        function runAccessibilityTests() {
            if (testingSuite) {
                return testingSuite.runAccessibilityTests();
            }
        }

        // Performance testing function
        function runPerformanceTests() {
            if (testingSuite) {
                return testingSuite.runPerformanceTests();
            }
        }

        // Initialize browser compatibility check
        document.addEventListener('DOMContentLoaded', () => {
            checkBrowserCompatibility();
        });

        // Keyboard shortcuts setup
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + Enter to calculate
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                const calculateBtn = document.getElementById('calculateButton');
                if (!calculateBtn.disabled) {
                    calculateCompensation();
                }
            }
        });

        // Print functionality
        function printResults() {
            window.print();
        }

        // Export functionality (simulated)
        function exportResults() {
            const results = document.getElementById('resultContent');
            if (results && results.innerHTML) {
                const exportData = {
                    timestamp: new Date().toISOString(),
                    results: results.textContent,
                    disclaimer: 'This is an educational estimate only. Consult legal professionals for actual case assessment.'
                };
                
                // In a real application, this would download a file
                console.log('Export data ready:', exportData);
                errorHandler.announceToScreenReader('Results prepared for export');
            }
        }

        // Memory management
        window.addEventListener('beforeunload', () => {
            if (calculator && calculator.cleanup) {
                calculator.cleanup();
            }
        });

        // Service Worker registration (for PWA capabilities)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    // Would register service worker in production
                    console.log('üîß Service Worker support available');
                } catch (error) {
                    console.log('Service Worker registration failed');
                }
            });
        }
    </script>
</body>
</html>